#!/usr/bin/env bash

source "$HOME"/benchy_imaged.sh

# XXX: Every fixture definition must have functions:
#   - prepare
#   - warmup
#   - measure_witness
#   - measure_proving
#   - measure_verifying


# Prepare to warmup and then benchmark a specific fixture.
prepare ()
{
    # Compile circuit to bytecode so `nargo execute` does not include that time. We don't care about benchmarking compilation since it only consists of the lowering to ACVM bytecode IIRC. Nothing to do with witness generation happens here.
    nargo compile --force --workspace --silence-warnings
}

warmup ()
{
    puts 'Warming up benchmark fixture...'

    for ((i = 0 ; i < max ; i++ )); do
        echo "$i"
    done

    puts '... done'
}

measure_witness ()
{
    echo 'hi there'
}

measure_proving ()
{
    echo 'TODO: Proving'
}

measure_verifying ()
{
    echo 'TODO: Verifying'
}

benchmark ()
{
    call prepare
}

printf '\033[35m------------ AZTEC BENCHMARKS ------------\033[0m\n'

benchmark

